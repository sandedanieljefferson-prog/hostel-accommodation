<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Bookings - Hostelhub</title>
  <link rel="stylesheet" href="theme.css">
  <style>
    body { margin:0; font-family:'Segoe UI',Arial,sans-serif; background:#73badb; color:#222; }
    .container { max-width:1100px; margin:40px auto 100px; background:#7ebbdf; border-radius:16px; box-shadow:0 2px 16px rgba(0,0,0,0.07); padding:40px 30px; }
    .header-row { display:flex; align-items:center; justify-content:space-between; position:relative; }
    .header-side { width:80px; display:flex; align-items:center; justify-content:flex-start; }
    .header-center { flex:1; display:flex; justify-content:center; align-items:center; position:absolute; left:0; right:0; pointer-events:none; }
    .header-center h1 { color:red; font-size:2.5rem; margin:0; pointer-events:auto; }
    #dashboardIcon { cursor:pointer; margin-left:0; }
    #dashboardIcon img { width:40px; height:40px; border-radius:50%; }
    .register-link img { width:40px; height:40px; border-radius:20px; }
    #dashboardMenu { display:none; position:absolute; right:40px; top:90px; background:#fff; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.15); padding:18px 24px; z-index:2000; }
    #dashboardMenu ul { list-style:none; margin:0; padding:0; }
    #dashboardMenu li { margin-bottom:10px; }
  .footer { background: linear-gradient(45deg,#ffb84d,#ff7a2d); color:#fff; text-align:center; padding:24px 0 16px; position:fixed; width:100vw; bottom:0; left:0; z-index:1000; }
    .hostel-card { display:flex; align-items:center; background:#fafafa; margin:12px 0; padding:12px; border-radius:10px; box-shadow:0 1px 4px rgba(0,0,0,0.05); }
    .hostel-card img { width:90px; height:90px; object-fit:cover; border-radius:8px; margin-right:15px; }
    .hostel-info { flex:1; }
    .pay-btn { background:#007bff; color:#fff; border:none; padding:8px 14px; border-radius:6px; cursor:pointer; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-row">
      <div class="header-side">
        <span id="dashboardIcon"><img src="MTN LOGO.png" alt="Dashboard"></span>
      </div>
      <div class="header-center"><h1>HOSTELHUB</h1></div>
      <div class="header-side" style="justify-content:flex-end;">
        <a class="register-link" href="login.html"><img src="MTN LOGO.png" alt="Register/Login"></a>
      </div>
    </div>
    <div id="dashboardMenu">
      <ul>
        <li><a href="about.html">About Us</a></li>
        <li><a href="terms.html">Terms & Conditions</a></li>
        <li><a href="help.html">Help & FAQs</a></li>
        <li><a href="hostels.html">Available Hostels</a></li>
        <li><a href="bookings.html">Bookings</a></li>
        <li><a href="login.html">Login</a></li>
        <li><a href="register.html">Register</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </div>
    <h1>Your Bookings</h1>
    <div id="bookingsList"></div>
  </div>
  <footer class="footer"></footer>

  <script>
    document.getElementById('dashboardIcon').onclick = function(e) {
      e.stopPropagation();
      const menu = document.getElementById('dashboardMenu');
      menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
    };
    document.body.onclick = function() {
      const menu = document.getElementById('dashboardMenu');
      if (menu) menu.style.display = 'none';
    };

    const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
    const bookingsList = document.getElementById('bookingsList');

    if (bookings.length === 0) {
      bookingsList.innerHTML = "<p>No bookings yet.</p>";
    } else {
      bookingsList.innerHTML = bookings.map((b, i) => `
        <div class="hostel-card">
          <img src="${b.img}" alt="${b.name}">
          <div class="hostel-info">
            <h3>${b.name}</h3>
            <p>UGX ${Number(b.price).toLocaleString()}</p>
          </div>
          <div style="display:flex;gap:8px;">
            <button class="pay-btn" onclick="goToPayment(${i})">Pay</button>
            <button class="pay-btn" style="background:#6c757d;" onclick="deleteBooking(${i})">Delete</button>
          </div>
        </div>
      `).join('');
    }

    function goToPayment(i) {
      const b = bookings[i];
      localStorage.setItem('payIndex', i);
      localStorage.setItem('payHostelName', b.name);
      if (b.img) localStorage.setItem('payHostelImg', b.img);
      window.location.href = 'payment.html';
    }

    function deleteBooking(i) {
      const b = bookings[i];
      if (!b) return;
      if (!confirm(`Delete booking for ${b.name}?`)) return;
      bookings.splice(i,1);
      localStorage.setItem('bookings', JSON.stringify(bookings));
      try {
        let hostels = JSON.parse(localStorage.getItem('hostels')||'[]');
        const idx = hostels.findIndex(h=>h.name===b.name && h.location===b.location);
        if (idx>=0) { hostels[idx].status='Available'; localStorage.setItem('hostels', JSON.stringify(hostels)); }
      } catch {}
      location.reload();
    }
  </script>
</body>
</html>
